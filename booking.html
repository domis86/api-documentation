<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Musement API Doc</title>

    <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic'
          rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="http://thack.musement.com/thack_api/css/theme.css" type="text/css"/>
    <link rel="stylesheet" href="http://thack.musement.com/thack_api/css/theme-fixes.css" type="text/css"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
</head>
<body class="wy-body-for-nav">

    <div class="wy-grid-for-nav">

        <nav data-toggle="wy-nav-shift" class="wy-nav-side">
            <div class="wy-side-nav-search">
                <a href="http://thack.musement.com/thack_api/" class="fa fa-home"> Musement API Doc</a>
            </div>

            <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://thack.musement.com/thack_api/authentication.html">
                                Authentication
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://thack.musement.com/thack_api/catalog.html">
                                Catalog
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://thack.musement.com/thack_api/booking.html">
                                Booking
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://thack.musement.com/thack_api/cart.html">
                                Cart
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://thack.musement.com/thack_api/customer.html">
                                Customer
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://thack.musement.com/thack_api/search.html">
                                Search
                            </a>
                        </li>
                                            <li class="toctree-l1 ">
                            <a class="reference internal "
                               href="http://thack.musement.com/thack_api/glossary.html">
                                Glossary
                            </a>
                        </li>
                                    </ul>
            </div>
            &nbsp;
        </nav>

        <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

                        <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
                <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
                <a href="http://thack.musement.com/thack_api/">Musement API Doc</a>
            </nav>


                        <div class="wy-nav-content">
                <div class="rst-content">
                    <div role="main" class="document">
                        <h2 id="booking">Booking</h2>
<p>The booking process allows you to book an event. Once you have found the <em>Event</em> you want to book, using the search or browsing the catalogues, for a successful booking you have to follow this flow.</p>
<p>We assume you already retrieved the all the infomation for the <em>Event</em> using the call:</p>
<pre><code>GET /api/v3/events/{id}</code></pre>
<h3 id="booking-flow">Booking flow</h3>
<p><img src="http://musement.s3.amazonaws.com/documentation_images/booking.png" alt="Booking" /></p>
<ol>
<li>Search for the available dates for the <em>Event</em>. | <a href="https://thack.musement.com/documentation#get--api-v3-events-{id}-dates.{_format}">Test it</a></li>
</ol>
<p>Returns a list of all days with availabitiy for a specific <em>Event</em> over a period of time.</p>
<h4><em>Request</em></h4>
<pre><code>GET /api/v3/events/{id}/dates</code></pre>
<p>To specify the period you can use the parameters <code>from_date</code> and <code>end_date</code>. If none of these parameters are specified <code>from_date</code> is set to the current day. If <code>end_date</code> is not specified then <code>end_date</code> is set to the same as <code>from_date</code>.</p>
<p><strong>Examples:</strong></p>
<p><strong><em> No parameters </em></strong> </p>
<p><code>from_date</code> and <code>end_date</code> are set as the current day. This call returns the current date if there is availabitiy, an empty array otherwise.</p>
<pre><code>GET /api/v3/events/497/dates</code></pre>
<p><strong><em> With parameters </em></strong> </p>
<p>Search for available dates for December 2016</p>
<pre><code>GET /api/v3/events/497/dates?from_date=2016-12-01&amp;end_date=2016-12-31</code></pre>
<p><strong>Example Response:</strong></p>
<p>The response is a collection of dates</p>
<pre><code>[
  {
    "date": "2016-01-14"
  },
  {
    "date": "2016-01-25"
  }
]</code></pre>
<h3 id="3-find-tickets-available-for-selected-day">3 Find tickets available for selected day</h3>
<p>Once you have found the date, the next step is to search for all available tickets for that day. Please note that for the same event different days can have different types of tickets.</p>
<h4><em>Request</em></h4>
<p><code>GET /events/{id}/dates/{YYYY-MM-DD}</code> | [Test it]</p>
<p>The response is a collection of items containing : </p>
<ul>
<li><code>datetime</code> - The date and time. For a single day an event may have multiple starting times.</li>
<li><code>seats</code> - A collection of all available <code>seats</code> (AKA <code>tickets</code>). Here you can find the seat structure.</li>
<li><code>open_ticket</code> - If true the event is an <code>Open ticket</code></li>
<li><code>availability</code> - Number of place available</li>
<li><code>languages</code> - The event may be available in different languages. Different times may also have different languages</li>
</ul>
<p><code>seat</code> structure:</p>
<ul>
<li><code>id</code> - Unique seat identifier</li>
<li><code>price_tag</code> - Info about the <code>seat</code> (person) the ticket is for: ticket type (<code>name</code>) and type of person (<code>group</code>). Please note that for the same date and time the combination of <code>name</code> and <code>group</code>  is unique but you can have multiple seats with the same <code>group</code> or <code>name</code></li>
<li><code>max_buy</code> and <code>min_buy</code> - Maximum and minimum number of ticket purchasable in a single transaction</li>
<li><code>raw_price</code> and <code>retail_price</code> - Internal and public price</li>
</ul>
<h4><em>Example</em></h4>
<p><code>GET /api/v3/events/497/dates/2016-01-15</code></p>
<p>Response</p>
<pre><code>[
  {
    "datetime": "2016-01-14T13:45:00+0000",
    "seats": [
      {
        "id": 8216618,
        "price_tag": {
          "name": "Full price",
          "group": "Tour",
          "locale": "en"
        },
        "max_buy": 15,
        "min_buy": 1,
        "raw_price": {
          "currency": "EUR",
          "value": 40,
          "formatted_value": "€ 40.00"
        },
        "retail_price": {
          "currency": "EUR",
          "value": 40,
          "formatted_value": "€ 40.00"
        }
      }
    ],
    "open_ticket": false,
    "availability": 9,
    "languages": [
      "en"
    ]
  }
]</code></pre>
<h3 id="create-the-order">Create the order</h3>
<p>When the cart is completed (<strong>with customer info filled in</strong>) and you want to finalize it (proceed with payments and check the availability one last time) </p>
<pre><code>POST /api/v3/orders

{
    "cart_id": 123456
}</code></pre>
<h3 id="finalize-the-order">Finalize the order</h3>
<p>If the order amount is equal to 0 or you use your payment gateway, use the flow without payment (ask for activation). Otherwise follow the Payment flow in 4.4.2.</p>
<h4 id="without-payment-flow">Without Payment Flow</h4>
<pre><code>POST /api/v3/payments/no-payment

{
    "orderId": 123456
}</code></pre>
<h4 id="with-payment-flow">With Payment Flow</h4>
<h5 id="braintree-payments">Braintree Payments</h5>
<p>You have to integrate <a href="https://developers.braintreepayments.com/">Braintree SDK</a></p>
<p><strong>Note</strong> When testing use credit card numbers contained in this link <a href="https://developers.braintreepayments.com/reference/general/testing/ruby#credit-card-numbers">https://developers.braintreepayments.com/reference/general/testing/ruby#credit-card-numbers</a> </p>
<h6 id="step-1">Step 1</h6>
<p>Get the nonce</p>
<pre><code>POST /api/v3/payments/braintree/token</code></pre>
<p>Response </p>
<pre><code>{
  "nonce": "eyJ2ZXJzaW9uIjoyLCJhdXRob3JpemF0aW9uRmluZ2VycHJpbnQiOiI3MDVjY2JlZThmZDRkNzI3MW" 
}</code></pre>
<h6 id="step-2">Step 2</h6>
<p>Using Braintree SDK, ask the user for payment information (credit card, paypal etc). Look at the <a href="https://developers.braintreepayments.com/">Braintree documentation</a> for more details.</p>
<h6 id="step-3">Step 3</h6>
<p>After the user fills out the Braintree payment form, ask us to process the payment and close the order by sending a </p>
<pre><code>POST /api/v3/payments/braintree/payment

{
  "nonce" : "nonce_string",
  "orderId" : 123456
}</code></pre>
                    </div>

                    <footer>
                        <hr/>
                                                Built with <a href="http://couscous.io/">Couscous</a> using a <a href="https://github.com/CouscousPHP/Template-ReadTheDocs">theme</a> based on <a href="https://readthedocs.org/">Read the Docs</a>.
                    </footer>

                </div>
            </div>

        </section>

    </div>

    <script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
    <script src="http://thack.musement.com/thack_api/js/theme.js"></script>

    <script>
        $(function() {
            // Syntax highlighting
            hljs.initHighlightingOnLoad();
        });
    </script>

</body>
</html>
